<!DOCTYPE html>
<html>
<head>
	<title>Quản lí mượn sách</title>
	<% include ../partials/head %>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		html, body{
			height: 100%
		}
	</style>
</head>
<body style="margin-right: 0 !important; overflow-y: auto;">	
	<%include ../partials/header%>
	<div style="min-height: 85%"> 
		<% include ../partials/anhchay %>
		<div class="container" style="margin-top: 20px; ">  
			<div class="row">
				<div class="form-group">
					<div class="col-sm-3">
						<a href="/quanLyMuonSach">
							<h4 style="color: red;"><b>Danh sách mượn sách</b></h4>
						</a>
					</div> 
				</div> 
				<form action="/quanLyMuonSach" method="get">
					<div class="form-group">
						<div class="col-sm-3 col-sm-offset-2">
							<input type="text" class="form-control" placeholder="Tìm kiếm tại đây..." name="noi_dung_tim_kiem">
						</div>
						<div class="col-sm-1">
							<div class="btn-group"> 
								<button type="submit" class="btn btn-primary"><span class="glyphicon glyphicon-search"></span>Tìm kiếm</button>
							</div> 
						</div>  
					</div>					
				</form>
				<div class="col-sm-2" style="float: right;">
					<button type="button" class="btn btn-primary" style="text-align: right;" data-toggle="modal" data-target="#myModal">Thêm phiếu mượn</button>
					<!-- Modal -->
				 	<div class="modal fade" id="myModal" role="dialog">
				    	<div class="modal-dialog modal-lg">
				    
				      	<!-- Noi dung cua modal -->
				      	<div class="modal-content">
					        <div class="modal-header">
					          <button type="button" class="close" data-dismiss="modal">&times;</button>
					          <h4 class="modal-title">Thêm phiếu mượn</h4>
					        </div>

					        <!-- Thong tin phieu muon -->
					        <div class="modal-body">
					        	<div class="form-inline"> <!-- Date input -->
							        <label>Ngày mượn</label>
							        <input id="NgayMuon" name="date" placeholder="yyyy-mm-dd" type="text"/>
							        <label>Thời hạn mượn</label>
							        <input id="ThoiHanMuon" type="text"/>
							    </div>
							    <hr>
							    <div class="form-group">
								    <div class="panel panel-primary">
										<div class="panel-heading">
											Thông tin độc giả
										</div>
										<div class="panel-body">
											<div class="form-inline">
							       				<label>Mã độc giả: </label>
							       				<input type="text" class="form-control" required="" id="MaDocGia">
						           			</div>
										    <div class="form-group-inline">
							       				<label >Tên độc giả: </label>
							       				<input type="text" class="form-control" required="" id="TenDocGia" disabled="">
						           			</div>
						           			<div class="form-group-inline">
							       				<label>Email: </label>
							       				<input type="text" class="form-control" required="" id="Email" disabled="">
						           			</div>
						           			<div class="form-group-inline">
							       				<label>Số điện thoại: </label>
							       				<input type="text" class="form-control" required="" id="SoDienThoai" disabled="">
						           			</div>
											
										</div>
									</div>
									<div class="panel panel-primary">
										<div class="panel-heading">
											Thông tin sách mượn
										</div>
										<div class="panel-body">
											<div class="form-inline">
							       				<label>Mã vạch: </label>
							       				<input type="text" class="form-control" required="" id="MaVach">
												<table class="table table-striped">
													<thead>
														<tr>
															<th>STT</th>
															<th>Mã vạch</th>
															<th>Tên sách</th>
															<th>Số lượng</th>
														</tr>
													</thead>
													<tbody>
														
													</tbody>
												</table>
						           			</div>
										</div>
									</div>
									<label>Tổng số sách mượn: </label>
									<input type="text" class="form-control" required="" id="TongSoSachMuon" disabled="">
									<label>Tổng tiền cọc: </label>
									<input type="text" class="form-control" required="" id="TongTienCoc" disabled="">
								</div>	
				       		</div>
				      		<div class="modal-footer">  
					        	<button type="button" id="taomoi" class="btn btn-primary" style="width: 90px;" onclick="themPhieuMuon();">Tạo mới</button>
					        	<button type="button" class="btn btn-default" data-dismiss="modal" style="width: 90px;" id="close">Close</button> 
					        </div>  
				 		</div>
				 	</div>
				 	<!-- Ket thuc modal -->
				</div>
			</div>
			<br><br>
			<hr> 
			<div id="danh_sach_muon_sach">
				<table class="table table-striped">
					<thead>
						<tr>
							<th>STT</th>
							<th>Mã vạch</th>
							<th>Mã thẻ</th>
							<th>Ngày mượn</th>
							<th>Thời hạn mượn</th>
							<th>Tiền cọc</th>
							<th>Hành động</th>
						</tr>
					</thead>
					<tbody> 
						<%for (var i=0; i<danhSachMuonSach.length; i++){%>
							<tr>
								<td><%=i+1%></td>
								<td><%=danhSachMuonSach[i].MaVach%></td>
								<td><%=danhSachMuonSach[i].MaThe%></td>
								<td><%=danhSachMuonSach[i].NgayMuon%></td>
								<td><%=danhSachMuonSach[i].ThoiHanMuon%></td>
								<td><%=danhSachMuonSach[i].TienCoc%></td>
								<td>
									<button type="submit" class="btn btn-default" name="edit" id="buttonEdit" onclick="layTTPhieuMuon(<%=danhSachMuonSach[i].id%>, '<%=danhSachMuonSach[i].MaVach%>', '<%=danhSachMuonSach[i].MaThe%>', '<%=danhSachMuonSach[i].NgayMuon%>', '<%=danhSachMuonSach[i].ThoiHanMuon%>', '<%=danhSachMuonSach[i].TienCoc%>');" data-toggle="modal" data-target="#editModal">
									    <span class="glyphicon glyphicon-wrench"></span>
									</button>  
									<button type="submit" class="btn btn-default" name="delete" id="buttonDelete" data-toggle="modal" data-target="#deleteModal">
									    <span class="glyphicon glyphicon-trash"></span>
									</button>			
									<!-- Modal -->
								 	<div class="modal fade" id="deleteModal" role="dialog">
								    	<div class="modal-dialog modal-lg">
								    
								      	<!-- Noi dung cua modal -->
								      	<div class="modal-content">
									        <div class="modal-header">
									          <button type="button" class="close" data-dismiss="modal">&times;</button>
									          <h4 class="modal-title">Xoá phiếu mượn</h4>
									        </div>

									        <!-- Thong tin cua nhan vien -->
									        <div class="modal-body">  
								        		<p>Bạn có chắc chắn muốn xóa không?</p>
									       	</div>
								      		<div class="modal-footer">  
									        	<button type="button" id="xoa" class="btn btn-primary" style="width: 90px;" onclick="xoaPhieuMuon();">OK</button>
									        	<button type="button" class="btn btn-default" data-dismiss="modal" style="width: 90px;" id="close_Delete">Cancel</button> 
									        </div>  
								 		</div>
								 	</div>
								 	<!-- Ket thuc Modal -->			
													
																		
								</td>

							</tr>	 
						<%};%>
					</tbody>
				</table>
				<hr>
				<p>Tổng số sách mượn: </p>
				<p>Tổng số tiền cọc: </p>
				<% var url = "/quanLyMuonSach" + "?noi_dung_tim_kiem=" + noi_dung_tim_kiem;
				var i = 1;%> 
				<div class="container" align="right">
					<hr class="mt-2 mb-5">	
					<%if (pageCount > 1) { %>
				        <ul class="pagination">
				            <% if (currentPage > 1) { %>
				                <li><a href=<%=url + "&page=1"%>>&laquo;</a></li>
				            <% }
				            
				            if (currentPage > 5) {
				                i = currentPage - 4;
				            } %>
				            <% if (i !== 1) { %>
				                <li class="disabled"><a href="#">...</a></li>
				            <% } %>
				            <% for (i; i<=pageCount; i++) { %>
				                <% if (currentPage == i) { %>
				                    <li class="active"><span><%= i %> <span class="sr-only">(current)</span></span></li>
				                <% } else { %> 
				                    <li><a href=<%=url+"&page="+ i %>><%= i %></a></li>
				                <% } %>
				                <% if (i == (currentPage + 4)) { %>
				                    <li class="disabled"><a href="#">...</a></li>
				                <% break; } %>
				            <% } %>
				            <% if (currentPage != pageCount) { %>
				                <li><a href=<%=url+"&page="+ pageCount %>>&raquo;</a></li>
				            <% } %>
				        </ul>
				    <% } %>	
			</div>
			<!-- Modal -->
		 	<div class="modal fade" id="editModal" role="dialog">
		    	<div class="modal-dialog modal-lg">
		    
		      	<!-- Noi dung cua modal -->
		      	<div class="modal-content">
			        <div class="modal-header">
			          <button type="button" class="close" data-dismiss="modal">&times;</button>
			          <h4 class="modal-title">Sửa thông tin phiếu mượn</h4>
			        </div>

			        <!-- Thong tin cua nhan vien -->
			        <div class="modal-body">  
		        		<div class="form-inline"> <!-- Date input -->
					        <label>Ngày mượn</label>
					        <input id="NgayMuon" name="date" placeholder="yyyy-mm-dd" type="text"/>
					        <label>Thời hạn mượn</label>
					        <input id="ThoiHanMuon" type="text"/>
					    </div>
					    <hr>
					    <div class="form-group">
						    <div class="panel panel-primary">
								<div class="panel-heading">
									Thông tin độc giả
								</div>
								<div class="panel-body">
									<div class="form-inline">
					       				<label>Mã độc giả: </label>
					       				<input type="text" class="form-control" required="" id="MaDocGia_Edit">
				           			</div>
								    <div class="form-group-inline">
					       				<label >Tên độc giả: </label>
					       				<input type="text" class="form-control" required="" id="TenDocGia" disabled="">
				           			</div>
				           			<div class="form-group-inline">
					       				<label>Email: </label>
					       				<input type="text" class="form-control" required="" id="Email" disabled="">
				           			</div>
				           			<div class="form-group-inline">
					       				<label>Số điện thoại: </label>
					       				<input type="text" class="form-control" required="" id="SoDienThoai" disabled="">
				           			</div>
									
								</div>
							</div>
							<div class="panel panel-primary">
								<div class="panel-heading">
									Thông tin sách mượn
								</div>
								<div class="panel-body">
									<div class="form-inline">
					       				<label>Mã vạch: </label>
					       				<input type="text" class="form-control" required="" id="MaVach_Edit">
										<table class="table table-striped">
											<thead>
												<tr>
													<th>STT</th>
													<th>Mã vạch</th>
													<th>Tên sách</th>
													<th>Số lượng</th>
												</tr>
											</thead>
											<tbody>
												
											</tbody>
										</table>
				           			</div>
								</div>
							</div>
							<label>Tổng số sách mượn: </label>
							<input type="text" class="form-control" required="" id="TongSoSachMuon_Edit" disabled="">
							<label>Tổng tiền cọc: </label>
							<input type="text" class="form-control" required="" id="TongTienCoc_Edit" disabled="">
						</div>   
			       	</div>
		      		<div class="modal-footer">  
			        	<button type="button" id="luu" class="btn btn-primary" style="width: 90px;" onclick="suaNV();">Lưu</button>
			        	<button type="button" class="btn btn-default" data-dismiss="modal" style="width: 90px;" id="close_Edit">Close</button> 
			        </div>  
		 		</div>
		 	</div>
		 	<!-- Ket thuc Modal -->	
		</div>	 
	</div>
</body>
<script type="text/javascript">
	$(document).ready(function(){
	    var date_input=$('input[name="date"]'); //our date input has the name "date"
	    var container=$('.bootstrap form').length>0 ? $('.bootstrap form').parent() : "body";
	    var options={
	    	format: 'yyyy-mm-dd',
	        container: container,
	        todayHighlight: true,
	        autoclose: true,
	    };
	    date_input.datepicker(options);
	})
</script>
</html>